# Создание API при помощи встроенных средств apex.oracle.com

Oracle предоставляет возможности легкого создания API. Подобное решение можно использовать в учебных целях.

О том, что такое API можно почитать тут (до части Tutorial, в нем в кратце описано как сделать API собственными средствами) [API](https://bitbucket.org/For_Victory/unidubnadb/src/master/API/API.md)

## Инструкция

SQL Workshop -> RESTful Services

ORDS RESTful Services

Далее необходимо нажать на кнопку "Register Schema with ORDS" и оставить можно все настройки по умолчанию.

После этого создастся один стандартный модуль с employees. Можно посмотреть его.

Нажмите на кнопку Modules и создайте новый. Придумайте название и можно поменять другие параметры.

Дальше находясь в нужном модуле создайте Template, указать название, если есть входные параметры их можно указать в таком виде animals/:id в таком случае :id можно использовать внутри запроса

```
Select *
from animals
where id = :id
```

В таком случае при обращении по адресу animals/1 будет получена вся информация о животном с заданным id (т.е. 1)

Для созданного Template необходимо создать Handler. В нём необходимо указать метод GET - получение. PUT - изменение. POST - добавление. DELETE - удаление.

Для 1-го примера сделаем GET.

Также необходимо выбрать Source Type. Я не буду сильно останавливаться на отличии каждого из вариантов - более подробно о них можно почитать, нажав на кнопку с "?".

Для нас подходит вариант Collection Query, который вернёт всё в формате JSON. Ну и PL/SQL, может пригодится - запускает только анонимные блоки.

Напишите любой запрос, допустим, получения всех животных (если делали без входного параметра Template), либо для конкретного животного (если Template с входным параметром).

После создания GET запроса скопируйте и введите в адресную строку или используя дополнение Rest Client для Visual Studio Code или используя ПО Postman или любой другой вариант.

Посмотрите на результат - в формате JSON.

Как это использовать можно посмотреть в папке 1. Hello World

Далее можно создать POST, PUT, DELETE API. Их отличие в том, что их можно реализовать только при помощи PL/SQL.

Например, создайте к созданному Template animals Handler POST.

### PUT

Для создания PUT запроса есть единственный возможный Source Type - PL/SQL.

Для описания инструкций используется анонимный блок, т.е.

```
begin
...
end;
```

Если необходимо, то зона Declare. Можно использовать ранее написанные функции, процедуры, пакеты.

Важная особенность этой части - использование параметров:

1. name: X-APEX-FORWARD (стандартное название переменной), bind variable: location (можете назвать её как-нибудь по-другому), source type: Http Header, Access method: OUT, Data Type: String. Этот параметр возвращает результат запроса клиенту (в JSON формате).
2. name: X-APEX-STATUS-CODE, bind variable: status, source type: Http Header, Access method: OUT, Data Type: Integer. Этот параметр возвращает статус запроса (обычный HTTP код, можно найти. Успешно - 200)